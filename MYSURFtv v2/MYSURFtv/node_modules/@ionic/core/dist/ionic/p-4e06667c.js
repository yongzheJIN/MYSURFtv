import{b as t,c as o}from"./p-f0b9a774.js";import{g as e}from"./p-01cf4201.js";import{OVERLAY_BACK_BUTTON_PRIORITY as n}from"./p-761d1bee.js";let a=0;const s=new WeakMap,i=t=>({create:o=>y(t,o),dismiss:(o,e,n)=>h(document,o,e,t,n),getTop:async()=>x(document,t)}),r=i("ion-alert"),c=i("ion-action-sheet"),d=i("ion-loading"),u=i("ion-modal"),p=i("ion-picker"),l=i("ion-popover"),m=i("ion-toast"),f=t=>{"undefined"!=typeof document&&b(document);const o=a++;t.overlayIndex=o,t.hasAttribute("id")||(t.id="ion-overlay-"+o)},y=(t,o)=>"undefined"!=typeof customElements?customElements.whenDefined(t).then(()=>{const e=document.createElement(t);return e.classList.add("overlay-hidden"),Object.assign(e,o),w(document).appendChild(e),e.componentOnReady()}):Promise.resolve(),v='[tabindex]:not([tabindex^="-"]), input:not([type=hidden]), textarea, button, select, .ion-focusable',b=t=>{0===a&&(a=1,t.addEventListener("focus",o=>((t,o)=>{const n=x(o),a=t.target;if(n&&a)if(n===a)n.lastFocus=void 0;else{const t=e(n).querySelector(".ion-overlay-wrapper");if(!t)return;if(t.contains(a))n.lastFocus=a;else{const e=n.lastFocus;((t,o)=>{let e=t.querySelector(v);const n=e&&e.shadowRoot;n&&(e=n.querySelector("input:not([type=hidden]), textarea, button, select")||e),e?e.focus():o.focus()})(t,n),e===o.activeElement&&((t,o)=>{const e=Array.from(t.querySelectorAll(v));let n=e.length>0?e[e.length-1]:null;const a=n&&n.shadowRoot;a&&(n=a.querySelector("input:not([type=hidden]), textarea, button, select")||n),n?n.focus():o.focus()})(t,n),n.lastFocus=o.activeElement}}})(o,t),!0),t.addEventListener("ionBackButton",o=>{const e=x(t);e&&e.backdropDismiss&&o.detail.register(n,()=>e.dismiss(void 0,G))}),t.addEventListener("keyup",o=>{if("Escape"===o.key){const o=x(t);o&&o.backdropDismiss&&o.dismiss(void 0,G)}}))},h=(t,o,e,n,a)=>{const s=x(t,n,a);return s?s.dismiss(o,e):Promise.reject("overlay does not exist")},x=(t,o,e)=>{const n=((t,o)=>(void 0===o&&(o="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(t.querySelectorAll(o)).filter(t=>t.overlayIndex>0)))(t,o);return void 0===e?n[n.length-1]:n.find(t=>t.id===e)},g=async(e,n,a,s,i)=>{if(e.presented)return;e.presented=!0,e.willPresent.emit();const r=t(e),c=e.enterAnimation?e.enterAnimation:o.get(n,"ios"===r?a:s);await j(e,c,e.el,i)&&e.didPresent.emit(),e.keyboardClose&&e.el.focus()},k=async(e,n,a,i,r,c,d)=>{if(!e.presented)return!1;e.presented=!1;try{e.el.style.setProperty("pointer-events","none"),e.willDismiss.emit({data:n,role:a});const u=t(e),p=e.leaveAnimation?e.leaveAnimation:o.get(i,"ios"===u?r:c);"gesture"!==a&&await j(e,p,e.el,d),e.didDismiss.emit({data:n,role:a}),s.delete(e)}catch(u){console.error(u)}return e.el.remove(),!0},w=t=>t.querySelector("ion-app")||t.body,j=async(t,e,n,a)=>{n.classList.remove("overlay-hidden");const i=e(n.shadowRoot||t.el,a);t.animated&&o.getBoolean("animated",!0)||i.duration(0),t.keyboardClose&&i.beforeAddWrite(()=>{const t=n.ownerDocument.activeElement;t&&t.matches("input, ion-input, ion-textarea")&&t.blur()});const r=s.get(t)||[];return s.set(t,[...r,i]),await i.play(),!0},B=(t,o)=>{let e;const n=new Promise(t=>e=t);return E(t,o,t=>{e(t.detail)}),n},E=(t,o,e)=>{const n=a=>{t.removeEventListener(o,n),e(a)};t.addEventListener(o,n)},P=t=>"cancel"===t||t===G,A=t=>t(),z=(t,e)=>{if("function"==typeof t)return o.get("_zoneGate",A)(()=>{try{return t(e)}catch(o){console.error(o)}})},G="backdrop";export{G as B,r as a,c as b,l as c,g as d,f as e,k as f,B as g,s as h,P as i,d as l,u as m,p,z as s,m as t}